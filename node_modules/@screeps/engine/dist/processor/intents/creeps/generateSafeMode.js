'use strict';

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var _ = require('lodash'),
    utils = require('../../../utils'),
    driver = utils.getDriver(),
    C = driver.constants;

module.exports = function (object, intent, roomObjects, roomTerrain, bulk, bulkUsers, roomController, stats, gameTime) {

    if (object.spawning) {
        return;
    }

    var target = roomObjects[intent.id];
    if (!target || target.type != 'controller') {
        return;
    }
    if (Math.abs(target.x - object.x) > 1 || Math.abs(target.y - object.y) > 1) {
        return;
    }
    if (!(object[C.RESOURCE_GHODIUM] >= C.SAFE_MODE_COST)) {
        return;
    }

    bulk.update(target, { safeModeAvailable: (target.safeModeAvailable || 0) + 1 });
    bulk.update(object, _defineProperty({}, C.RESOURCE_GHODIUM, object[C.RESOURCE_GHODIUM] - C.SAFE_MODE_COST));
};
//# sourceMappingURL=../../../sourcemaps/processor/intents/creeps/generateSafeMode.js.map
