{"version":3,"sources":["processor/intents/creeps/upgradeController.js"],"names":["_","require","utils","driver","getDriver","C","constants","config","module","exports","object","intent","roomObjects","roomTerrain","bulk","bulkUsers","roomController","stats","gameTime","type","spawning","energy","target","id","Math","abs","x","y","level","user","upgradeBlocked","_upgraded","buildPower","filter","body","i","hits","_oldHits","WORK","length","UPGRADE_CONTROLLER_POWER","buildEffect","min","boostedParts","map","boost","BOOSTS","upgradeController","CONTROLLER_MAX_UPGRADE_PER_TICK","sort","a","b","slice","boostedEffect","floor","sum","nextLevelProgress","CONTROLLER_LEVELS","ptr","tutorial","progress","downgradeTime","CONTROLLER_DOWNGRADE","sendNotification","room","safeModeAvailable","inc","actionLog","update"],"mappings":"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","file":"../../../../processor/intents/creeps/upgradeController.js","sourceRoot":"/src"}